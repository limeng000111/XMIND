(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{Aqrb:function(e,t,a){"use strict";a.r(t);a("SMEU");var r=a("xc0u"),n=(a("C1KP"),a("d6B9")),s=(a("nPjb"),a("nKmx")),o=(a("Mf8d"),a("4OHk")),i=(a("26gd"),a("1GiV")),c=a("mK77"),l=a.n(c),d=a("xwgP"),p=a.n(d),m=(a("nXRE"),a("on7z")),u={getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},setcookie(e,t){var a=new Date;a.setTime(a.getTime()+2592e6),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()}};t.default=n.a.create()(class extends p.a.PureComponent{constructor(e){super(e),this.typeChange=(e=>{this.setState({type:e},()=>{this.props.form.resetFields()})}),this.onOk=(()=>{this.props.form.validateFields((e,t)=>{e||(this.setState({loading:!0}),"1"===this.state.type?Object(m.a)("/user/login",{method:"POST",body:l()({},t)}).then(e=>{e&&200===e.code?(i.a.success("登陆成功"),window.location.href=u.getQueryString("jumpto")):i.a.error(e.msg),this.setState({loading:!1})}):Object(m.a)("/user/register",{method:"POST",body:l()({},t)}).then(e=>{e&&200===e.code?(i.a.success("注册成功"),window.location.href=u.getQueryString("jumpto")):i.a.error(e.msg),this.setState({loading:!1})}))})}),this.state={type:"1",loading:!1}}render(){var e=this.props.form.getFieldDecorator,t=this.state,a=t.type,i=t.loading;return p.a.createElement("div",{className:"login"},p.a.createElement("div",{className:"card"},p.a.createElement("div",{className:"title"},"AgileTC",p.a.createElement("span",null,"一套敏捷的测试用例管理平台")),p.a.createElement("span",{className:"1"===a?"btn btn_active":"btn",onClick:()=>this.typeChange("1")},"登录"),p.a.createElement("span",{className:"2"===a?"btn btn_active":"btn",onClick:()=>this.typeChange("2")},"注册"),p.a.createElement("div",{className:"input"},p.a.createElement(n.a.Item,{label:""},e("username",{rules:[{required:!0,message:"请填写账号"}],initialValue:void 0})(p.a.createElement(s.a,{placeholder:"账号",prefix:p.a.createElement(o.a,{type:"user"})}))),"1"===a&&p.a.createElement(n.a.Item,{label:""},e("password",{rules:[{required:!0,message:"请填写密码"}],initialValue:void 0})(p.a.createElement(s.a.Password,{placeholder:"密码",prefix:p.a.createElement(o.a,{type:"lock"})}))),"2"===a&&p.a.createElement(n.a.Item,{label:""},e("password",{rules:[{required:!0,message:"请填写密码"}],initialValue:void 0})(p.a.createElement(s.a.Password,{placeholder:"密码",prefix:p.a.createElement(o.a,{type:"lock"})})))),p.a.createElement(r.a,{type:"primary",className:"onBtn",loading:i,onClick:()=>this.onOk()},"1"===a?"登录":"注册并登录")))}})},nXRE:function(e,t,a){e.exports={login:"login",card:"card",title:"title",btn:"btn",btn_active:"btn_active",input:"input",onBtn:"onBtn",zIndex:"zIndex"}},on7z:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a("dmE+");var r=a("SseY"),n=a("mK77"),s=a.n(n),o=a("gq5N"),i=a.n(o);window.apiPrefix="/api",i.a.defaults.timeout=3e5,i.a.defaults.withCredentials=!0;var c={200:"服务器成功返回请求的数据。",201:"新建或修改数据成功。",202:"一个请求已经进入后台排队（异步任务）。",204:"删除数据成功。",400:"发出的请求有错误，服务器没有进行新建或修改数据的操作。",401:"用户没有权限（令牌、用户名、密码错误）。",403:"用户得到授权，但是访问是被禁止的。",404:"发出的请求针对的是不存在的记录，服务器没有进行操作。",406:"请求的格式不可得。",410:"请求的资源被永久删除，且不会再得到的。",422:"当创建一个对象时，发生一个验证错误。",500:"服务器发生错误，请检查服务器。",502:"网关错误。",503:"服务不可用，服务器暂时过载或维护。",504:"网关超时。"};function l(e,t){var a={};if(a.method=void 0!==t?t.method:"get",t&&(t.body&&(a.data="string"==typeof t.body?JSON.parse(t.body):t.body),void 0!==t.params)){for(var n in e+="?",t.params)void 0!==t.params[n]&&""!==t.params[n]&&(e=e+n+"="+t.params[n]+"&");e=e.substring(0,e.length-1)}return i()(s()({url:e},a)).then(e=>{if(401===e.data.code||401===e.code){var t="".concat(e.data.data.login_url,"?app_id=").concat(e.data.data.app_id),a=encodeURIComponent(window.location.href),r="".concat(t,"&version=1.0&jumpto=").concat(a);return window.location.href=r,Promise.reject(new Error("服务不可用，请联系管理员"))}if(99993===e.data.code||99993===e.code){return window.location.href="/login",Promise.reject(new Error("服务不可用，请联系管理员"))}return s()({},e.data)}).catch(e=>{if(e.response){var t=e.response.status,a=c[t]||e.response.statusText;return r.a.error({message:"请求错误 ".concat(t),description:a}),{code:t,message:a}}})}i.a.interceptors.request.use(e=>(e.baseURL=window.apiPrefix,e),e=>Promise.reject(e)),i.a.interceptors.response.use(e=>e,e=>Promise.reject(e))}}]);